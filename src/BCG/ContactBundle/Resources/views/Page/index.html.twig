{% extends 'BCGContactBundle::layout.html.twig' %}

{% block navigation %}
	{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
    	<div id="logged-in-as">Logged in as: {{ app.user.username }}</div>
    	<a id="logout-btn" class="btn btn-primary" href="{{ path('fos_user_security_logout') }}">Log out</a>
	{% else %}
		{{ render(url('fos_user_security_login')) }}
	{% endif %}
{% endblock %}

{% block body %}
	<div class="page-title col-md-6 col-md-offset-3">
		Agencies
	</div>

	{% for agency in agencies %}
	    <div class="agency {{ cycle(['odd', 'even'], loop.index0) }} col-md-12">
	        <div class="col-md-3">
	            <h2>{{ agency.name }}</h2>
	            <div class="established">
	                Established:<br>
	                <time datetime="{{ agency.established|date('c') }}">{{ agency.established|date('F j, Y') }}</time>
	            </div>
	        </div>
	        
	        <div class="contact col-md-5 col-md-offset-1">
	            <h4>Contact Information</h4>
	            <div class="c-content">
		            <p>{{ agency.phone }}</p>
		            <p>{{ agency.email }}</p>
		            <p>{{ agency.address }}</p>
	            </div>
	        </div>

	        <div class="col-md-2 col-md-offset-1">
	            <h4>Users: </h4>
	            	{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
			            <p><a href="{{ path('BCGContactBundle_agency_show', { 'id': agency.id }) }}">View Users</a></p>
			            <p><a href="{{ path('BCGContactBundle_agency_show', { 'id': agency.id }) }}">Edit Agency</a></p>
		            {% endif %}
	        </div>

	        
		</div>
	{% else %}
	    <p>No Agencies exist.</p>
	{% endfor %}

{% endblock %}
